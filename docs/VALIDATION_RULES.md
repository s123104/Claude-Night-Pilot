# é©—è­‰è¦å‰‡èˆ‡æœ€ä½³å¯¦è¸

> åŸºæ–¼ Conventional Commitsã€Semantic Versioning å’Œç¾ä»£ DevOps æœ€ä½³å¯¦è¸çš„ä¼æ¥­ç´šé©—è­‰æ¡†æ¶

## ğŸ¯ æ ¸å¿ƒåŸå‰‡

### 1. èªç¾©ç‰ˆæœ¬æ§åˆ¶ (Semantic Versioning)
éµå¾ª [SemVer 2.0.0](https://semver.org/) æ¨™æº–ï¼š
- **MAJOR** (X.0.0): ç ´å£æ€§è®Šæ›´ (`feat!:`, `fix!:`, `BREAKING CHANGE:`)
- **MINOR** (0.X.0): æ–°åŠŸèƒ½ï¼Œå‘ä¸‹ç›¸å®¹ (`feat:`)
- **PATCH** (0.0.X): éŒ¯èª¤ä¿®å¾©ï¼Œå‘ä¸‹ç›¸å®¹ (`fix:`)

### 2. ç´„å®šå¼æäº¤ (Conventional Commits)
éµå¾ª [Conventional Commits 1.0.0](https://www.conventionalcommits.org/) è¦ç¯„ï¼š

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

#### å…è¨±çš„é¡å‹ (Types)
- `feat`: æ–°åŠŸèƒ½
- `fix`: éŒ¯èª¤ä¿®å¾©
- `docs`: æ–‡æª”è®Šæ›´
- `style`: ä»£ç¢¼é¢¨æ ¼ (ä¸å½±éŸ¿åŠŸèƒ½)
- `refactor`: é‡æ§‹ (æ—¢éæ–°åŠŸèƒ½ä¹ŸééŒ¯èª¤ä¿®å¾©)
- `perf`: æ€§èƒ½æ”¹é€²
- `test`: æ¸¬è©¦ç›¸é—œ
- `build`: å»ºç½®ç³»çµ±æˆ–å¤–éƒ¨ä¾è³´
- `ci`: CI/CD é…ç½®
- `chore`: å…¶ä»–ä¸ä¿®æ”¹ src æˆ– test çš„è®Šæ›´
- `revert`: å›æ»¾å…ˆå‰çš„æäº¤

#### ç¯„åœ (Scopes)
- `core`: æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„
- `gui`: åœ–å½¢ä½¿ç”¨è€…ä»‹é¢
- `cli`: å‘½ä»¤åˆ—ä»‹é¢
- `db`: è³‡æ–™åº«ç›¸é—œ
- `scheduler`: æ’ç¨‹ç³»çµ±
- `executor`: åŸ·è¡Œå¼•æ“
- `security`: å®‰å…¨ç›¸é—œ
- `test`: æ¸¬è©¦æ¡†æ¶
- `docs`: æ–‡æª”ç³»çµ±
- `deps`: ä¾è³´ç®¡ç†
- `config`: é…ç½®ç®¡ç†
- `ci`: æŒçºŒæ•´åˆ
- `release`: ç™¼å¸ƒç›¸é—œ

### 3. è‡ªå‹•åŒ–ç‰ˆæœ¬ç®¡ç†å·¥å…·é¸æ“‡

#### ä¸»è¦å·¥å…·æ¯”è¼ƒ
| å·¥å…· | ç”Ÿæ…‹ç³»çµ± | è‡ªå‹•åŒ–ç¨‹åº¦ | é…ç½®è¤‡é›œåº¦ | æ¨è–¦å ´æ™¯ |
|------|----------|------------|------------|----------|
| **semantic-release** | npm (primary) | å…¨è‡ªå‹• | ä¸­ç­‰ | å®Œå…¨è‡ªå‹•åŒ–ç™¼å¸ƒ |
| **standard-version** | npm | åŠè‡ªå‹• | ç°¡å–® | éœ€è¦äººå·¥å¯©æ ¸ |
| **conventional-semver-rs** | Rust | åŠè‡ªå‹• | ç°¡å–® | Rust åŸç”Ÿå°ˆæ¡ˆ |
| **release-plz** | Rust | å…¨è‡ªå‹• | ä¸­ç­‰ | Rust ç”Ÿæ…‹ç³»çµ± |

#### æœ¬å°ˆæ¡ˆé¸æ“‡ï¼š`standard-version` + `conventional-semver-rs`
**ç†ç”±**ï¼š
- æ”¯æ´ npm + Rust é›™é‡ç”Ÿæ…‹ç³»çµ±
- ä¿æŒäººå·¥å¯©æ ¸æ§åˆ¶æ¬Š
- é…ç½®ç°¡å–®ï¼Œç¶­è­·æˆæœ¬ä½
- å®Œæ•´æ”¯æ´ Conventional Commits

## ğŸ“‹ é©—è­‰æª¢æŸ¥æ¸…å–®

### 1. é æäº¤æª¢æŸ¥ (Pre-commit)
```bash
# ä»£ç¢¼å“è³ªæª¢æŸ¥
npm run lint:rust              # Rust Clippy æª¢æŸ¥
npm run format:check           # ä»£ç¢¼æ ¼å¼æª¢æŸ¥
npm run test:rust:unit         # Rust å–®å…ƒæ¸¬è©¦

# é¡å‹æª¢æŸ¥
npm run typecheck              # TypeScript æª¢æŸ¥ (å¦‚é©ç”¨)

# å®‰å…¨æª¢æŸ¥
cargo audit                    # ä¾è³´å®‰å…¨æƒæ
```

### 2. é æ¨é€æª¢æŸ¥ (Pre-push)
```bash
# å®Œæ•´æ¸¬è©¦å¥—ä»¶
npm run test:all               # å…¨éƒ¨æ¸¬è©¦ (157 Rust + 176 E2E)
npm run test:coverage          # ä»£ç¢¼è¦†è“‹ç‡æª¢æŸ¥

# æ€§èƒ½åŸºæº–æ¸¬è©¦
npm run bench:all              # å…¨éƒ¨æ€§èƒ½åŸºæº–æ¸¬è©¦

# å»ºç½®é©—è­‰
npm run cli:build              # CLI å·¥å…·å»ºç½®
npm run tauri build            # GUI æ‡‰ç”¨å»ºç½®
```

### 3. ç™¼å¸ƒå‰æª¢æŸ¥ (Pre-release)
```bash
# ç‰ˆæœ¬ä¸€è‡´æ€§æª¢æŸ¥
check_version_consistency      # package.json èˆ‡ Cargo.toml åŒæ­¥

# æ–‡æª”æ›´æ–°æª¢æŸ¥
check_changelog_updated        # CHANGELOG.md æ˜¯å¦æ›´æ–°
check_readme_updated           # README.md ç‰ˆæœ¬è™Ÿæ˜¯å¦æ­£ç¢º

# å®Œæ•´åŠŸèƒ½é©—è­‰
npm run verify:all             # å…¨åŠŸèƒ½é©—è­‰æ¸¬è©¦
```

## ğŸ”§ è‡ªå‹•åŒ–è…³æœ¬æ¶æ§‹

### 1. é©—è­‰ä¸»è…³æœ¬çµæ§‹
```bash
scripts/
â”œâ”€â”€ validation/
â”‚   â”œâ”€â”€ pre-commit.sh         # é æäº¤æª¢æŸ¥
â”‚   â”œâ”€â”€ pre-push.sh           # é æ¨é€æª¢æŸ¥
â”‚   â”œâ”€â”€ version-sync.js       # ç‰ˆæœ¬åŒæ­¥æª¢æŸ¥
â”‚   â””â”€â”€ test-all.sh           # å…¨æ¸¬è©¦åŸ·è¡Œ
â”œâ”€â”€ versioning/
â”‚   â”œâ”€â”€ bump-version.js       # ç‰ˆæœ¬è™Ÿæ›´æ–°
â”‚   â”œâ”€â”€ generate-changelog.js # æ›´æ–°æ—¥èªŒç”Ÿæˆ
â”‚   â””â”€â”€ release-check.sh      # ç™¼å¸ƒå‰æª¢æŸ¥
â””â”€â”€ logging/
    â”œâ”€â”€ error-logger.js       # éŒ¯èª¤æ—¥èªŒç³»çµ±
    â””â”€â”€ test-reporter.js      # æ¸¬è©¦çµæœå ±å‘Š
```

### 2. éŒ¯èª¤æ—¥èªŒåˆ†é¡
```bash
logs/
â”œâ”€â”€ validation/
â”‚   â”œâ”€â”€ pre-commit-{timestamp}.log
â”‚   â”œâ”€â”€ pre-push-{timestamp}.log
â”‚   â””â”€â”€ test-results-{timestamp}.log
â”œâ”€â”€ performance/
â”‚   â”œâ”€â”€ benchmark-{timestamp}.log
â”‚   â””â”€â”€ startup-performance-{timestamp}.log
â””â”€â”€ errors/
    â”œâ”€â”€ compilation-errors-{timestamp}.log
    â”œâ”€â”€ test-failures-{timestamp}.log
    â””â”€â”€ runtime-errors-{timestamp}.log
```

## ğŸ“Š å“è³ªé–€æª»æ¨™æº–

### 1. ä»£ç¢¼è¦†è“‹ç‡è¦æ±‚
- **å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡**: â‰¥ 80%
- **æ•´åˆæ¸¬è©¦è¦†è“‹ç‡**: â‰¥ 70%
- **E2E æ¸¬è©¦è¦†è“‹ç‡**: â‰¥ 90% (é—œéµç”¨æˆ¶æµç¨‹)
- **ç¸½é«”è¦†è“‹ç‡**: â‰¥ 75%

### 2. æ€§èƒ½åŸºæº–è¦æ±‚
- **CLI å•Ÿå‹•æ™‚é–“**: â‰¤ 100ms (ç›®æ¨™: 11.7ms)
- **GUI å•Ÿå‹•æ™‚é–“**: â‰¤ 3s (ç›®æ¨™: <2s)
- **è¨˜æ†¶é«”ä½¿ç”¨**: â‰¤ 150MB (ç›®æ¨™: <120MB)
- **è³‡æ–™åº«æŸ¥è©¢**: â‰¤ 50ms (å…¸å‹æ“ä½œ)

### 3. å®‰å…¨è¦æ±‚
- **ä¾è³´å®‰å…¨æƒæ**: 0 å€‹é«˜å±æ¼æ´
- **ä»£ç¢¼éœæ…‹åˆ†æ**: 0 å€‹å®‰å…¨è­¦å‘Š
- **æ¬Šé™æª¢æŸ¥**: å®Œæ•´æ¬Šé™é©—è­‰
- **è¼¸å…¥é©—è­‰**: 100% ç”¨æˆ¶è¼¸å…¥é©—è­‰

### 4. å»ºç½®è¦æ±‚
- **ç·¨è­¯æ™‚é–“**: â‰¤ 5 åˆ†é˜ (release å»ºç½®)
- **åŸ·è¡Œæª”å¤§å°**: â‰¤ 10MB (ç›®æ¨™: ~8MB)
- **è·¨å¹³å°æ”¯æ´**: Windows, macOS, Linux
- **ä¾è³´ç›¸å®¹æ€§**: ç„¡è¡çªä¾è³´

## ğŸš€ è‡ªå‹•åŒ–æµç¨‹å®šç¾©

### 1. é–‹ç™¼æµç¨‹
```mermaid
graph TD
    A[ä»£ç¢¼è®Šæ›´] --> B[Pre-commit Hook]
    B --> C{æª¢æŸ¥é€šé?}
    C -->|å¦| D[ä¿®å¾©å•é¡Œ]
    D --> B
    C -->|æ˜¯| E[æäº¤åˆ°æœ¬åœ°]
    E --> F[Pre-push Hook]
    F --> G{æ¸¬è©¦é€šé?}
    G -->|å¦| H[ä¿®å¾©æ¸¬è©¦]
    H --> F
    G -->|æ˜¯| I[æ¨é€åˆ°é ç«¯]
```

### 2. ç™¼å¸ƒæµç¨‹
```mermaid
graph TD
    A[åˆä½µåˆ° main] --> B[CI/CD è§¸ç™¼]
    B --> C[å…¨æ¸¬è©¦åŸ·è¡Œ]
    C --> D{æ¸¬è©¦é€šé?}
    D -->|å¦| E[é˜»æ­¢ç™¼å¸ƒ]
    D -->|æ˜¯| F[ç‰ˆæœ¬è™Ÿæ›´æ–°]
    F --> G[CHANGELOG ç”Ÿæˆ]
    G --> H[Git Tag å»ºç«‹]
    H --> I[Release ç™¼å¸ƒ]
```

### 3. éŒ¯èª¤è™•ç†æµç¨‹
```mermaid
graph TD
    A[éŒ¯èª¤ç™¼ç”Ÿ] --> B[è¨˜éŒ„åˆ°æ—¥èªŒ]
    B --> C[éŒ¯èª¤åˆ†é¡]
    C --> D[é€šçŸ¥ç›¸é—œäººå“¡]
    D --> E[è‡ªå‹•é‡è©¦?]
    E -->|æ˜¯| F[åŸ·è¡Œé‡è©¦]
    E -->|å¦| G[äººå·¥ä»‹å…¥]
    F --> H{é‡è©¦æˆåŠŸ?}
    H -->|æ˜¯| I[è¨˜éŒ„æ¢å¾©]
    H -->|å¦| G
```

## ğŸ“ æª”æ¡ˆç‰ˆæœ¬ç®¡ç†è¦ç¯„

### 1. æª”æ¡ˆé ­éƒ¨è¨»é‡‹æ¨™æº–
```rust
//! Claude Night Pilot - Core Module
//! 
//! Version: 0.1.1
//! Last Updated: 2025-08-13
//! Author: Claude Night Pilot Team
//! 
//! Description:
//! æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„ï¼Œæä¾› Claude CLI æ•´åˆèˆ‡è‡ªå‹•åŒ–æ’ç¨‹åŠŸèƒ½
//! 
//! Features:
//! - Claude Code æ·±åº¦æ•´åˆ
//! - æ™ºæ…§æ’ç¨‹ç³»çµ±
//! - ä¼æ¥­ç´šå®‰å…¨åŠŸèƒ½
//! 
//! Dependencies:
//! - tokio: éåŒæ­¥é‹è¡Œæ™‚
//! - rusqlite: SQLite è³‡æ–™åº«æ¥å£
//! - serde: åºåˆ—åŒ–æ¡†æ¶
```

### 2. ç‰ˆæœ¬åŒæ­¥æª¢æŸ¥
ç¢ºä¿ä»¥ä¸‹æª”æ¡ˆç‰ˆæœ¬è™Ÿä¸€è‡´ï¼š
- `package.json` â†’ `version`
- `src-tauri/Cargo.toml` â†’ `version`
- `README.md` â†’ ç‰ˆæœ¬å¾½ç« 
- `CHANGELOG.md` â†’ æœ€æ–°ç‰ˆæœ¬è¨˜éŒ„

### 3. è‡ªå‹•æ›´æ–°ç›®æ¨™
- âœ… **ç‰ˆæœ¬è™ŸåŒæ­¥**: è‡ªå‹•åŒæ­¥æ‰€æœ‰é…ç½®æª”æ¡ˆ
- âœ… **æ›´æ–°æ—¥èªŒ**: åŸºæ–¼ Conventional Commits è‡ªå‹•ç”Ÿæˆ
- âœ… **Git æ¨™ç±¤**: è‡ªå‹•å»ºç«‹èªç¾©ç‰ˆæœ¬æ¨™ç±¤
- âœ… **Release Notes**: è‡ªå‹•ç”Ÿæˆç™¼å¸ƒèªªæ˜
- âœ… **æ–‡æª”æ›´æ–°**: è‡ªå‹•æ›´æ–° README å’Œ API æ–‡æª”

## ğŸ›¡ï¸ å®‰å…¨é©—è­‰è¦å‰‡

### 1. ä»£ç¢¼å®‰å…¨
- **éœæ…‹åˆ†æ**: cargo clippy + å®‰å…¨ lint è¦å‰‡
- **ä¾è³´æƒæ**: cargo audit å®šæœŸæª¢æŸ¥
- **ç¥•å¯†æª¢æ¸¬**: é˜²æ­¢ API é‡‘é‘°ç­‰æ•æ„Ÿè³‡è¨Šæäº¤
- **æ¬Šé™æœ€å°åŒ–**: æœ€å°æ¬Šé™åŸå‰‡å¯¦æ–½

### 2. é‹è¡Œæ™‚å®‰å…¨
- **è¼¸å…¥é©—è­‰**: æ‰€æœ‰å¤–éƒ¨è¼¸å…¥åš´æ ¼é©—è­‰
- **æ²™ç›’åŸ·è¡Œ**: Claude CLI åŸ·è¡Œéš”é›¢
- **å¯©è¨ˆæ—¥èªŒ**: å®Œæ•´æ“ä½œè¨˜éŒ„èˆ‡è¿½è¹¤
- **éŒ¯èª¤è™•ç†**: å®‰å…¨çš„éŒ¯èª¤è¨Šæ¯è™•ç†

### 3. è³‡æ–™å®‰å…¨
- **æœ¬åœ°å„²å­˜**: æ•æ„Ÿè³‡æ–™æœ¬åœ°åŠ å¯†
- **å‚³è¼¸å®‰å…¨**: TLS åŠ å¯†é€šè¨Š
- **è³‡æ–™å‚™ä»½**: è‡ªå‹•å‚™ä»½èˆ‡æ¢å¾©
- **éš±ç§ä¿è­·**: é›¶é›²ç«¯ä¾è³´è¨­è¨ˆ

## ğŸ“ˆ æŒçºŒæ”¹é€²æ©Ÿåˆ¶

### 1. æŒ‡æ¨™ç›£æ§
- **å»ºç½®æˆåŠŸç‡**: ç›®æ¨™ â‰¥ 95%
- **æ¸¬è©¦ç©©å®šæ€§**: ç›®æ¨™ â‰¥ 98%
- **æ€§èƒ½å›æ­¸**: è‡ªå‹•æª¢æ¸¬èˆ‡è­¦å ±
- **å®‰å…¨æ¼æ´**: é›¶å®¹å¿æ”¿ç­–

### 2. å›é¥‹å¾ªç’°
- **å®šæœŸå›é¡§**: æ¯é€±é©—è­‰è¦å‰‡å›é¡§
- **å·¥å…·æ›´æ–°**: è¿½è¹¤æœ€æ–°æœ€ä½³å¯¦è¸
- **æµç¨‹å„ªåŒ–**: åŸºæ–¼æ•¸æ“šçš„æµç¨‹æ”¹é€²
- **åœ˜éšŠåŸ¹è¨“**: æœ€ä½³å¯¦è¸çŸ¥è­˜å…±äº«

### 3. è‡ªå‹•åŒ–æ“´å±•
- **æ–°å·¥å…·è©•ä¼°**: å®šæœŸè©•ä¼°æ–°çš„è‡ªå‹•åŒ–å·¥å…·
- **æµç¨‹æ¨™æº–åŒ–**: å¯é‡è¤‡çš„æ¨™æº–åŒ–æµç¨‹
- **éŒ¯èª¤é é˜²**: å¾éŒ¯èª¤ä¸­å­¸ç¿’ä¸¦é é˜²
- **æ•ˆç‡æå‡**: æŒçºŒå„ªåŒ–é–‹ç™¼é«”é©—

---

**å¯¦æ–½å„ªå…ˆç´š**:
1. ğŸš¨ **ç«‹å³**: åŸºæœ¬é©—è­‰è…³æœ¬å’ŒéŒ¯èª¤æ—¥èªŒ
2. ğŸ“… **æœ¬é€±**: ç‰ˆæœ¬åŒæ­¥å’Œè‡ªå‹•åŒ–æ›´æ–°
3. ğŸ“… **ä¸‹é€±**: å®Œæ•´ CI/CD æ•´åˆ
4. ğŸ“… **æœ¬æœˆ**: é«˜ç´šç›£æ§å’Œå›é¥‹æ©Ÿåˆ¶

**ç¶­è­·è²¬ä»»**:
- **è…³æœ¬ç¶­è­·**: é–‹ç™¼åœ˜éšŠ
- **è¦å‰‡æ›´æ–°**: æ¶æ§‹å¸«
- **ç›£æ§å‘Šè­¦**: DevOps åœ˜éšŠ
- **å®‰å…¨å¯©è¨ˆ**: å®‰å…¨åœ˜éšŠ