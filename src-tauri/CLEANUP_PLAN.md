# 数据库重构清理计划

## 🎯 重构目标
建立统一的数据库架构，消除技术债务，提供清晰的 Repository 模式。

## ✅ 已完成
1. **新架构创建完成**
   - `core/database/` 模块架构
   - 统一的 DatabaseManager
   - Repository 模式实现
   - 错误处理和类型定义
   - 迁移管理系统

2. **编译通过**
   - 代码可以正常编译
   - 保持向后兼容性
   - 使用旧的数据库管理器作为过渡

## 🧹 清理任务

### Phase 1: 标记废弃文件 (安全)
- [x] `database_manager.rs` - 已标记为废弃
- [ ] `db.rs` - 被注释掉，可以安全删除  
- [ ] `simple_database_manager.rs` - 可能重复

### Phase 2: 清理未使用的导入
- [ ] 清理 `manager.rs` 中未使用的导入
- [ ] 清理 `repository.rs` 中未使用的导入
- [ ] 清理 `lib.rs` 中未使用的导入

### Phase 3: 修复警告
- [ ] 修复 base64 废弃函数使用
- [ ] 处理未使用的变量和静态项
- [ ] 清理未使用的函数

### Phase 4: 逐步迁移 (后续)
- [ ] 迁移 Tauri 命令到新数据库架构
- [ ] 删除旧的数据库管理器
- [ ] 更新所有调用点

## 🚨 安全注意事项
1. **不要删除**：
   - `database_manager_impl.rs` (当前在使用)
   - `simple_db.rs` (当前在使用)
   - `database_error.rs` (可能被引用)

2. **删除前检查**：
   - 搜索所有引用
   - 确认没有外部依赖
   - 备份重要代码

3. **保持向后兼容**：
   - 不破坏现有 API
   - 渐进式迁移
   - 保留过渡期支持

## 📝 当前状态
- ✅ 新架构完成并编译通过
- ✅ 向后兼容性保持
- 🔄 开始清理阶段
- ⏳ 等待逐步迁移